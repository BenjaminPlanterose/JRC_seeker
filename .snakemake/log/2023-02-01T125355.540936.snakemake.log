Config file /home/ben/Git/JRC_seeker/sample_data/test_config.json is extended by additional config specified via the command line.
Building DAG of jobs...
Using shell: /bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job stats:
job                 count    min threads    max threads
----------------  -------  -------------  -------------
all                     1              1              1
binarize                1              1              1
binokulars              1              1              1
binpolish               1              1              1
epiread                 1              1              1
format_meth_data        1              1              1
label_states            1              1              1
learnmodel              1              1              1
meth_info               1              1              1
pileup                  1              1              1
process_epiread         1              1              1
total                  11              1              1

Select jobs to execute...

[Wed Feb  1 12:53:55 2023]
rule pileup:
    input: /home/ben/Git/JRC_seeker/sample_data/sample_data.bam, /home/ben/Git/JRC_seeker/sample_data/reference_genome/chr12.fa
    output: /media/ben/DATA/Ben/13_JRC/test_JRC_seeker/biscuit_output/my_pileup.vcf.gz
    jobid: 7
    reason: Missing output files: /media/ben/DATA/Ben/13_JRC/test_JRC_seeker/biscuit_output/my_pileup.vcf.gz; Code has changed since last execution; Params have changed since last execution
    resources: tmpdir=/tmp

[Wed Feb  1 12:54:03 2023]
Finished job 7.
1 of 11 steps (9%) done
Select jobs to execute...

[Wed Feb  1 12:54:03 2023]
rule meth_info:
    input: /home/ben/Git/JRC_seeker/sample_data/reference_genome/chr12.fa, /media/ben/DATA/Ben/13_JRC/test_JRC_seeker/biscuit_output/my_pileup.vcf.gz
    output: /media/ben/DATA/Ben/13_JRC/test_JRC_seeker/biscuit_output/meth_info.bed
    jobid: 6
    reason: Missing output files: /media/ben/DATA/Ben/13_JRC/test_JRC_seeker/biscuit_output/meth_info.bed; Input files updated by another job: /media/ben/DATA/Ben/13_JRC/test_JRC_seeker/biscuit_output/my_pileup.vcf.gz
    resources: tmpdir=/tmp

[Wed Feb  1 12:54:08 2023]
Finished job 6.
2 of 11 steps (18%) done
Select jobs to execute...

[Wed Feb  1 12:54:08 2023]
rule epiread:
    input: /media/ben/DATA/Ben/13_JRC/test_JRC_seeker/biscuit_output/my_pileup.vcf.gz
    output: /media/ben/DATA/Ben/13_JRC/test_JRC_seeker/biscuit_output/test_run.epiread, /media/ben/DATA/Ben/13_JRC/test_JRC_seeker/biscuit_output/test_run_snps.bed
    jobid: 10
    reason: Missing output files: /media/ben/DATA/Ben/13_JRC/test_JRC_seeker/biscuit_output/test_run.epiread; Input files updated by another job: /media/ben/DATA/Ben/13_JRC/test_JRC_seeker/biscuit_output/my_pileup.vcf.gz
    resources: tmpdir=/tmp

RuleException in rule epiread in file /home/ben/Git/JRC_seeker/Snakefile, line 203:
AttributeError: 'Params' object has no attribute 'region', when formatting the following:

		biscuit vcf2bed -t snp {input.pileup} > {output.snps}
		

		n_lines=$(wc -l < {params.chr_file})
		if [ $n_lines -eq 1 ]
		then
		        chr=$(awk '{{print $1}}' {params.chr_file})
		else
		        chr="none"
		fi
		if [ $chr != "none" ]
		then
			biscuit epiread -g {params.region} -o {params.path}/temp.epiread -O -B {output.snps} {params.ref_genome} {params.bam} > {params.path}/temp.epiread
		else
			biscuit epiread -o {params.path}/temp.epiread -O -B {output.snps} {params.ref_genome} {params.bam} > {params.path}/temp.epiread 
		fi	
		
		sort -T {params.temp} -k2,2 -k3,3n {params.path}/temp.epiread | awk 'BEGIN{{ qname="" ; rec="" }} 
			qname == $2 {{ print rec"	"$5"	"$6"	"$7"	"$8 ; qname="" }} 
			qname != $2 {{ qname=$2 ; rec=$1"	"$4"	"$5"	"$6"	"$7"	"$8 ; pair=$3}}' > {output.epiread}
		
		rm {params.path}/temp.epiread
		
